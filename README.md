# WinMediaSessionProvider

**WinMediaSessionProvider** - —ç—Ç–æ "–ª–µ–≥–∫–æ–≤–µ—Å–Ω–æ–µ" Windows-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–µ–∫—É—â–µ–π –º–µ–¥–∏–∞-—Å–µ—Å—Å–∏–∏ (–Ω–∞–∑–≤–∞–Ω–∏–µ —Ç—Ä–µ–∫–∞, –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å, —Å—Ç–∞—Ç—É—Å –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –∏ —Ç.–¥.) —á–µ—Ä–µ–∑ WebSocket-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å. –û–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ, –æ—Ç–æ–±—Ä–∞–∂–∞—è –∏–∫–æ–Ω–∫—É –≤ —Å–∏—Å—Ç–µ–º–Ω–æ–º —Ç—Ä–µ–µ, –∏ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏ –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

---

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

* –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ç–µ–∫—É—â–µ–π –º–µ–¥–∏–∞-—Å–µ—Å—Å–∏–∏ Windows 10/11
* –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏—Ö —Å–∏—Å—Ç–µ–º–Ω—ã–π –º–µ–¥–∏–∞-–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä (Spotify, Groove Music, YouTube –≤ Edge –∏ –¥—Ä.)
* WebSocket-—Å–µ—Ä–≤–µ—Ä –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–∞–º –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
* –†–∞–±–æ—Ç–∞ –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ

---

## üõ† –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

1. **–°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞:**

   * –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –≤–∞—Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω [.NET 8.0 SDK](https://dotnet.microsoft.com/en-us/download/dotnet/8.0).
   * –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:

     ```bash
     git clone https://github.com/gen1nya/WinMediaSessionProvider.git
     ```
   * –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –∫–∞—Ç–∞–ª–æ–≥ –ø—Ä–æ–µ–∫—Ç–∞ –∏ —Å–æ–±–µ—Ä–∏—Ç–µ –µ–≥–æ:

     ```bash
     cd WinMediaSessionProvider
     dotnet publish -c Release -r win-x64 --self-contained true /p:PublishSingleFile=true
     ```

2. **–ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:**

   * –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –ø–∞–ø–∫—É `bin\Release\net8.0-windows10.0.26100.0\win-x64\publish`.
   * –ó–∞–ø—É—Å—Ç–∏—Ç–µ `MediaSessionWSProvider.exe`. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ, –∏ –µ–≥–æ –∏–∫–æ–Ω–∫–∞ –ø–æ—è–≤–∏—Ç—Å—è –≤ —Å–∏—Å—Ç–µ–º–Ω–æ–º —Ç—Ä–µ–µ.

3. **–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ WebSocket-—Å–µ—Ä–≤–µ—Ä—É:**

   * WebSocket-—Å–µ—Ä–≤–µ—Ä –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É `ws://localhost:5001/ws/`.
   * –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ –Ω–µ–º—É —Å –ø–æ–º–æ—â—å—é –ª—é–±–æ–≥–æ WebSocket-–∫–ª–∏–µ–Ω—Ç–∞, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∞—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –æ —Ç–µ–∫—É—â–µ–π –º–µ–¥–∏–∞-—Å–µ—Å—Å–∏–∏.

---

## üìÜ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

* **–ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö:**

  * –ü–æ—Å–ª–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ WebSocket-—Å–µ—Ä–≤–µ—Ä—É –≤—ã –±—É–¥–µ—Ç–µ –ø–æ–ª—É—á–∞—Ç—å JSON-—Å–æ–æ–±—â–µ–Ω–∏—è —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ —Ç–µ–∫—É—â–µ–π –º–µ–¥–∏–∞-—Å–µ—Å—Å–∏–∏.
  * –ü—Ä–∏–º–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏—è:

    ```json
    {
      "type": "metadata",
      "data": {
        "title": "–ù–∞–∑–≤–∞–Ω–∏–µ —Ç—Ä–µ–∫–∞",
        "artist": "–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å",
        "albumTitle": "–ê–ª—å–±–æ–º",
        "albumArtBase64": "base64-–∫–æ–¥ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ–±–ª–æ–∂–∫–∏",
        "status": "Playing",
        "duration": 240.0,
        "position": 42.5
      }
    }
    ```

* **–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã:**

  * –©–µ–ª–∫–Ω–∏—Ç–µ –ø—Ä–∞–≤–æ–π –∫–Ω–æ–ø–∫–æ–π –º—ã—à–∏ –ø–æ –∏–∫–æ–Ω–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ —Å–∏—Å—Ç–µ–º–Ω–æ–º —Ç—Ä–µ–µ –∏ –≤—ã–±–µ—Ä–∏—Ç–µ "–í—ã—Ö–æ–¥", —á—Ç–æ–±—ã –∑–∞–≤–µ—Ä—à–∏—Ç—å —Ä–∞–±–æ—Ç—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

---

## üßë‚Äçüíª –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

* **–ü—Ä–æ–µ–∫—Ç:** `MediaSessionWSProvider`
* **–Ø–∑—ã–∫:** C#
* **–§—Ä–µ–π–º–≤–æ—Ä–∫:** .NET 8.0
* **–¢–∏–ø –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:** Windows Application (`WinExe`)
* **–û—Å–Ω–æ–≤–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**

  * `System.Net.WebSockets`
  * `Windows.Media.Control` (–¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –º–µ–¥–∏–∞-—Å–µ—Å—Å–∏—è–º)
  * `System.Text.Json`

---

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ–¥ –ª–∏—Ü–µ–Ω–∑–∏–µ–π MIT. –ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ —Å–º. –≤ —Ñ–∞–π–ª–µ [LICENSE](LICENSE).
